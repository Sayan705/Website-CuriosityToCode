<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sample Project</title>
</head>
<body>
    <header style="background: linear-gradient(90deg, #43e97b 0%, #38f9d7 100%); padding: 40px 0; text-align: center; color: #23272a; border-radius: 0 0 24px 24px; box-shadow: 0 2px 12px rgba(33,147,176,0.10);">
        <h1 style="font-size: 48px; margin: 0; font-weight: bold; letter-spacing: 2px;">Experimental & Fun</h1>
        <p style="font-size: 22px; margin-top: 18px; color: #23272a; font-weight: 500;">Sandbox Showcase: Where Ideas Take Shape</p>
    </header>
    <section style="max-width: 700px; margin: 40px auto; background: #f8fafc; border-radius: 18px; box-shadow: 0 2px 12px rgba(33,147,176,0.08); padding: 32px 36px; font-size: 20px; color: #23272a; line-height: 1.6; text-align:center;">
        <h2 style="font-size: 28px; color: #43e97b; margin-bottom: 24px;">File Converter</h2>
        <form action="/upload-doc" method="post" enctype="multipart/form-data" style="margin: 0 auto; display: inline-block;">
            <!-- Only .doc files are accepted for upload -->
            <label for="file-upload" style="font-size: 18px; color: #2193b0; font-weight: 600; margin-bottom: 12px; display: block;">Upload your Word file:</label>
            <input type="file" id="file-upload" name="file" accept=".doc" style="padding: 10px; border-radius: 8px; border: 1px solid #43e97b; margin-bottom: 18px;">
            <small style="display:block; color:#bfc9d1; margin-bottom:12px;">only word files are accpted</small>
            <br>
            <button type="submit" style="background: linear-gradient(90deg, #43e97b 0%, #38f9d7 100%); color: #23272a; font-size: 18px; font-weight: bold; border: none; border-radius: 8px; padding: 10px 28px; cursor: pointer; box-shadow: 0 2px 8px rgba(33,147,176,0.10);">Upload</button>
        </form>
    </section>
    <section style="max-width: 700px; margin: 32px auto; background: #e3f6fc; border-radius: 18px; box-shadow: 0 2px 12px rgba(33,147,176,0.08); padding: 32px 36px; font-size: 20px; color: #23272a; line-height: 1.6; text-align:center;">
        <h2 style="font-size: 28px; color: #2193b0; margin-bottom: 24px;">- Response Preview</h2>
        <div id="response-preview" style="min-height: 60px; background: #fff; border-radius: 10px; box-shadow: 0 1px 6px rgba(33,147,176,0.07); padding: 18px 24px; color: #23272a; font-size: 18px; text-align:left;">
            <!-- Output will be visible here as text -->
            <a id="pdf-download-link" href="#" style="display:none; color:#2193b0; font-weight:bold; font-size:20px; text-decoration:underline;">Download your PDF</a>
        </div>
    </section>
    <script>
        document.querySelector('form[action="/upload-doc"]').addEventListener('submit', function(e) {
            e.preventDefault();
            const formData = new FormData(this);
            fetch('/upload-doc', {
                method: 'POST',
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    return response.blob();
                } else {
                    return response.text().then(text => { throw new Error('Backend error: ' + text); });
                }
            })
            .then(blob => {
                const url = window.URL.createObjectURL(blob);
                const link = document.getElementById('pdf-download-link');
                link.href = url;
                link.style.display = 'inline-block';
                link.download = 'converted.pdf';
                link.textContent = 'Download your PDF';
                document.getElementById('response-preview').appendChild(link);
            })
            .catch(error => {
                document.getElementById('response-preview').textContent = error.message;
            });
        });
    </script>
</body>
</html>
